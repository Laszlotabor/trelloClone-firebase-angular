<div *ngIf="!loading && card" class="card-detail-container">
  <!-- Left: Main Content -->
  <div class="card-main-content">
    <!-- Back Button -->
    <div class="card-back-button">
      <button class="back-button" (click)="goBack()">← Back to Board</button>
    </div>

    <!-- Content -->
    <div class="card-content-wrapper">
      <!-- Image -->
      <div class="card-image-wrapper" *ngIf="card.imageUrl">
        <img [src]="card.imageUrl" alt="Card Image" />
      </div>

      <!-- Text + Actions -->
      <div class="card-text-wrapper">
        <h2 class="card-title">{{ card.title }}</h2>
        <p class="card-description" *ngIf="card.description">{{ card.description }}</p>

        <div class="card-actions">
          <button class="btn btn-outline-primary" (click)="startEditing()">✏️ Edit</button>
          <button class="btn btn-outline-danger" (click)="deleteCard()">🗑️ Delete</button>
          <button class="btn btn-outline-secondary" (click)="fileInput.click()">🖼️ Add Image</button>
          <input type="file" #fileInput (change)="onImageSelected($event)" hidden />
        </div>

        <!-- Edit Form -->
        <div *ngIf="isEditing" class="edit-form">
          <div class="form-group">
            <label>Title</label>
            <input [(ngModel)]="editableTitle" type="text" class="form-control" />
          </div>

          <div class="form-group">
            <label>Description</label>
            <textarea [(ngModel)]="editableDescription" class="form-control" rows="3"></textarea>
          </div>

          <div class="edit-buttons">
            <button class="btn btn-success" (click)="saveEdit()">💾 Save</button>
            <button class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right: Chat -->
  <div class="card-chat-panel">
    <ng-container *ngIf="card.id">
      <app-chat [cardId]="card.id"></app-chat>
    </ng-container>
  </div>
</div>
